
# Sess√£o 2 ‚Äì Docker para Aplica√ß√µes Django

## Objetivo da sess√£o
- Construir um Dockerfile completo para Django.
- Rodar Django via container.
- Trabalhar com volumes.
- Usar vari√°veis de ambiente.

---

## 1. Criando projeto Django
```bash
pip install django==4.2.7
django-admin startproject myproject .
```

---

## 2. requirements.txt
```txt
Django==4.2.7
psycopg2-binary==2.9.9
python-decouple==3.8
gunicorn==21.2.0
```

---

## 3. .dockerignore
```txt
__pycache__
*.pyc
env/
venv/
.git
*.sqlite3
```

---

## 4. Dockerfile para Django
```dockerfile
FROM python:3.11-slim
ENV PYTHONDONTWRITEBYTECODE=1     PYTHONUNBUFFERED=1
WORKDIR /app
RUN apt-get update && apt-get install -y     build-essential libpq-dev     && rm -rf /var/lib/apt/lists/*
COPY requirements.txt .
RUN pip install --upgrade pip && pip install --no-cache-dir -r requirements.txt
COPY . .
EXPOSE 8000
CMD ["python", "manage.py", "runserver", "0.0.0.0:8000"]
```

---

## 5. Executando Django
### Build
```bash
docker build -t django-app .
```
### Run
```bash
docker run -p 8000:8000 django-app
```

---

## 6. Volume para desenvolvimento
```bash
docker run -p 8000:8000 -v $(pwd):/app django-app
```

---

## 7. Vari√°veis de ambiente
### Executando com envs
```bash
docker run -p 8000:8000 -e DEBUG=True -e SECRET_KEY=abc django-app
```

---

## 8. Comandos Django no container
```bash
docker run django-app python manage.py migrate
docker run -it django-app python manage.py createsuperuser
```

---

## 9. Exerc√≠cios sugeridos
1. Criar view simples.
2. Testar DEBUG via vari√°vel de ambiente.
3. Executar migrations via container.


## Adi√ß√µes para trabalhar com outro banco 

---

## üìÅ Estrutura nova

```
.
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îú‚îÄ‚îÄ manage.py
‚îÇ   ‚îî‚îÄ‚îÄ myproject/
‚îú‚îÄ‚îÄ postgres/
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ .env
‚îî‚îÄ‚îÄ .dockerignore
```

---

## 10) Dockerfile do PostgreSQL

```dockerfile
FROM postgres:16

ENV POSTGRES_DB=django_db
ENV POSTGRES_USER=django
ENV POSTGRES_PASSWORD=django

EXPOSE 5432
```

---

## 11) Vari√°veis de ambiente (.env)

```env
DEBUG=True
SECRET_KEY=abc

DB_NAME=django_db
DB_USER=django
DB_PASSWORD=django
DB_HOST=postgres
DB_PORT=5432
```

---

## 11) settings.py (DATABASES)

```python
from decouple import config

DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.postgresql",
        "NAME": config("DB_NAME"),
        "USER": config("DB_USER"),
        "PASSWORD": config("DB_PASSWORD"),
        "HOST": config("DB_HOST"),
        "PORT": config("DB_PORT", cast=int, default=5432),
    }
}
```

---

## 12) Build das imagens

```bash
docker build -t django-app ./backend
docker build -t postgres-db ./postgres
```

---

## 13) Criar rede Docker

```bash
docker network create django-net
```

---

## 14) Rodar PostgreSQL

```bash
docker run -d \
  --name postgres \
  --network django-net \
  postgres-db
```

---

## 15) Rodar Django

```bash
docker run -p 8000:8000 \
  --name django \
  --network django-net \
  --env-file .env \
  django-app
```

---

## 16) Migrations e superuser

```bash
docker run --network django-net --env-file .env django-app python manage.py migrate

```

---

## 17) Volume para desenvolvimento

```bash
docker run -p 8000:8000 \
  --network django-net \
  --env-file .env \
  -v $(pwd)/backend:/app \
  django-app
```

---

